import java.io.IOException;
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import org.json.JSONObject;

public class RestApiClient {
    public static void main(String[] args) {

        double latitude = 52.52;
        double longitude = 13.41;
        String url = String.format(
                "https://api.open-meteo.com/v1/forecast?latitude=%f&longitude=%f&current_weather=true",
                latitude, longitude);

        try {

            HttpClient client = HttpClient.newHttpClient();
            HttpRequest request = HttpRequest.newBuilder()
                    .uri(URI.create(url))
                    .GET()
                    .build();

            HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());

            if (response.statusCode() == 200) {
                String responseBody = response.body();

                JSONObject json = new JSONObject(responseBody);
                JSONObject currentWeather = json.getJSONObject("current_weather");

                double temperature = currentWeather.getDouble("temperature");
                double windspeed = currentWeather.getDouble("windspeed");
                double winddirection = currentWeather.getDouble("winddirection");
                String time = currentWeather.getString("time");

                System.out.println("=== Current Weather Data ===");
                System.out.println("Location: Latitude " + latitude + ", Longitude " + longitude);
                System.out.println("Time: " + time);
                System.out.println("Temperature: " + temperature + " °C");
                System.out.println("Windspeed: " + windspeed + " km/h");
                System.out.println("Wind direction: " + winddirection + "°");
            } else {
                System.err.println("Failed to fetch data. HTTP code: " + response.statusCode());
            }

        } catch (IOException | InterruptedException e) {
            e.printStackTrace();
        }
    }
}
